---
import { DEFAULT_LANG, withLangPrefix } from '../i18n/config';

const fallbackPath = withLangPrefix('/', DEFAULT_LANG);
const italianPath = withLangPrefix('/', 'it');
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Redirecting...</title>
    <meta http-equiv="refresh" content={`0;url=${fallbackPath}`} />
    <link rel="canonical" href={fallbackPath} />
    <script is:inline>
      const { fallback = '', italian = '' } = document.body.dataset;
      const navLang = navigator.language || (navigator.languages && navigator.languages[0]) || '';
      const lang = navLang.toLowerCase().startsWith('it') ? italian : fallback;
      if (lang && window.location.pathname !== lang) {
        window.location.replace(lang);
      }
    </script>
  </head>
  <body data-fallback={fallbackPath} data-italian={italianPath}>
    <main class="container mx-auto p-6 text-center">
      <p>Redirecting... <a class="underline" href={fallbackPath}>Go to English</a> Â· <a class="underline" href={italianPath}>Vai alla versione italiana</a></p>
    </main>
  </body>
</html>
